"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ava_1 = require("ava");
const any_1 = require("../../../src/values/any");
const reduce_1 = require("../../../src/transforms/reduce");
ava_1.test('reduceTransform()', t => {
    // Throws when options does not have 'expression' or 'acc'
    t.throws(() => {
        reduce_1.default('[number]', {});
    });
    // Throws when options does not have 'expression'
    t.throws(() => {
        reduce_1.default('[number]', { acc: { value: 1 } });
    });
    // Throws when options does not have 'acc'
    t.throws(() => {
        reduce_1.default('[number]', { expression: { value: 1 } });
    });
    // Throws when value type does not match input type
    t.throws(() => {
        reduce_1.default('number', { acc: { value: 1 }, expression: { dep: '$element' } });
    });
    const section = reduce_1.default('[number]', {
        acc: { value: 10 },
        expression: {
            plus: [
                { dep: '$acc' },
                { dep: '$element' }
            ]
        }
    });
    t.is(section.input_type, '[number]');
    // TODO: Implement expression type inferrence
    t.is(section.output_type, 'b');
    t.deepEqual(section.deps, []);
    t.truthy(section.transform(any_1.toValue([1, 4, 7, 2]), {})
        .equals(any_1.toValue(24)));
});
//# sourceMappingURL=reduce_test.js.map