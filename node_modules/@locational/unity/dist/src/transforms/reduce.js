"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const any_1 = require("./any");
const parser_1 = require("../expression/parser");
function reduceTransform(value_type, options) {
    const expression = any_1.expectExpression(options);
    const acc = any_1.expectAcc(options);
    const { input_type, output_type } = any_1.matchTypes(value_type, '[{a}]', 'b');
    const section_deps = any_1.extractDeps(options);
    function transform(input, deps) {
        return input.content.reduce((acc, element) => {
            const local_deps = Object.assign({ '$element': element, '$acc': acc }, deps);
            const local_expression = parser_1.resolve_local(local_deps, expression);
            return parser_1.evaluate(local_expression);
        }, parser_1.evaluate(acc));
    }
    return {
        input_type,
        output_type,
        deps: section_deps,
        transform
    };
}
exports.default = reduceTransform;
//# sourceMappingURL=reduce.js.map