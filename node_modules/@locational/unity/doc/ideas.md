# Ideas

## Data flow

The main use case is presenting and manipulation of data collections.
To achieve that we put data from buckets through series of Filters and Transforms to
prepare it for usage in a Component.

Components may be grouped inside Pages.

All interactions (->) are typed.

Bucket -> [Filter|Transform] -> Component -> Page

## Buckets

Buckets are typed data stores.
Each bucket stores a tree of values, starting with the root value which determines the bucket type.

## Values


### Metadata

All values carry metadata for type checking and referencing.
Example of basic number value:
```
{
    "tag": "unique_identifier", // by default will be automatically generated as uuid
    "type": "number",
    "value": 123
}
```


### Basic types

Basic types do not have any special rules or restrictions.

#### Number

Single number value.

#### String

Single string value.

#### List

Ordered collection of values of the same type

#### Dictionary

Collection of key-value pairs with defined schema

Internal representation:
```
{
    "tag": "uuid",
    "type": "dictionary",
    "schema": {
        "name": "string",
        "age", "number"
    },
    "value": { 
        "name": {"tag": "uuid", "type": "string", "value": "John"},
        "age": {"tag": "uuid", "type": "number", "value": 27}
    }
}
```

### Special types

Special types have special rules or restrictions.

#### Enum

Value that can contain only one variant of another List value.
Example of enum value:
```
{
    "tag": "gender_list",
    "type": "list",
    "value": [{tag: "gender_male", type: "string", value: "male"}, {tag: "gender_female", type: "string", value: "female"}]
}

{
    "tag": "gender_enum",
    "type": "enum",
    "source": "@gender_list", // assuming we have a list value with tag "gender_list"
    "value": "@gender_male" // reference by tag
}
```

#### Table

A list of dictionaries. Dictionaries must have the same schema because list values must all be of the same type.


#### Computed

```
{
    "tag": "uuid",
    "type": "computed",
    "value": "@age + 10"
}
```

## Filters

Filters take a value and return a value of the same type or 'empty'
Example of number filter:
```
{
    "tag": "my_age",
    "type": "number",
    "value": 16
}
{
    "tag": "age_filter",
    "type": "filter",
    "source": "@my_age",
    "criteria": "$ > 18"
}

Output:
{"tag": "uuid", "type": "empty"}
```

Example of list filter
```
{
    "tag": "years",
    "type": "list",
    "value": [
        {"tag": "uuid", "type": "number", "value": 1990},
        {"tag": "uuid", "type": "number", "value": 1995},
        {"tag": "uuid", "type": "number", "value": 2000},
        {"tag": "uuid", "type": "number", "value": 2010}
    ]
}
{
    "tag": "millenial_filter",
    "type": "filter",
    "source": "@years",
    "criteria": "$ >= 2000"
}

Output:
{
    "tag": "uuid",
    "type": "list",
    "value": [
        {"tag": "uuid", "type": "number", "value": "@uuid"}, // @uuid value is a reference to original value in "years" list
        {"tag": "uuid", "type": "number", "value": "@uuid"}
    ]
}
```

## Transforms

Transforms take a value and return a derivative value of possibly different type.

Example of dictionary to list transform:
```
{
    "tag": "users",
    "type": "dictionary",
    "schema": {
        "name": "string",
        "age", "number"
    },
    "value": { 
        "name": {"tag": "uuid", "type": "string", "value": "John"},
        "age": {"tag": "uuid", "type": "number", "value": 27}
    }
}

{
    "tag": "dict_to_list_transform",
    "type": "transform",
    "action": "dictionary_to_list",
    "source": "@users"
}

Output:
{
    "tag": "uuid",
    "type": "list",
    "value": [
        {
            "tag": "uuid",
            "type": "list",
            "value": [
                { "tag": "uuid", "type": "string", "value": "@uuid" }
                { "tag": "uuid", "type": "number", "value": "@uuid" }
            ]
        },
        {
            "tag": "uuid",
            "type": "list",
            "value": [
                { "tag": "uuid", "type": "string", "value": "@uuid" }
                { "tag": "uuid", "type": "number", "value": "@uuid" }
            ]
        }
    ]
}
```

Other possible transforms:
* maximum (list -> number)
* concat (list -> list -> list)
* aggregate (list -> dictionary)
